VALIDAÇÃO DE AUTENTICAÇÃO E OWNERSHIP DE WORKSPACE
===================================================

✓ IMPLEMENTAÇÃO COMPLETA em todas as 3 Edge Functions do Instagram

1. instagram-discovery (supabase/functions/instagram-discovery/index.ts)
   - Linha 114: Função helper validateAuthAndWorkspace() definida
   - Linha 321: Validação no action='start' (após verificação de runData)
   - Linha 590: Validação no action='status' (após verificação de runData)

2. instagram-enrichment (supabase/functions/instagram-enrichment/index.ts)
   - Linha 95: Função helper validateAuthAndWorkspace() definida
   - Linha 271: Validação no action='start' (após verificação de runData)
   - Linha 532: Validação no action='check' (após verificação de runData)
   - Linha 774: Validação no action='status' (após verificação de runData)

3. instagram-migrate (supabase/functions/instagram-migrate/index.ts)
   - Linha 85: Função helper validateAuthAndWorkspace() definida
   - Linha 245: Validação no action='start' (após verificação de runData)
   - Linha 597: Validação no action='status' (após verificação de runData)

FUNCIONALIDADE:
---------------
A função validateAuthAndWorkspace():
1. Verifica se o header 'authorization' existe e tem formato 'Bearer <token>'
2. Valida o token JWT com supabase.auth.getUser()
3. Verifica se o usuário pertence ao workspace através da tabela workspace_members
4. Retorna erro 401 se qualquer validação falhar
5. Permite a execução apenas se o usuário for membro do workspace

SEGURANÇA:
----------
- Todas as ações (start, check, status) agora exigem autenticação
- O workspace_id é obtido do run_id (lead_extraction_runs.workspace_id)
- Usuários não podem acessar runs de workspaces que não pertencem
